@let result = userAnswers();

@if (result !== null) {
	@let questionsCount = questions().length;

	<h1 class="result-testName">{{ testName() }}</h1>
	<nz-divider class="result-divider" />
	<h2 class="result-title">Результаты тестирования</h2>

	<div class="result-questions-count">
		Всего вопросов: <span>{{ questionsCount }}</span>
	</div>
	<div class="result-user-answer-count">
		Отвечено на <span>{{ userCountAnswers() }}</span> из <span>{{ questionsCount }}</span> вопросов
	</div>
	<div class="result-user-answer-score">
		Вы набрали: <span>{{ myScore() }}</span> из <span>{{ questionsCount }}</span> баллов
		<span>({{ (myScore() / questionsCount) * 100 | number }}%)</span>
	</div>

	<button class="result-finish-button" nz-button nzType="primary" type="button" (click)="finishQuiz()">
		Завершить тестирование
	</button>

	<div class="result-table">
		<nz-table
			#resultTable
			nzSize="small"
			[nzBordered]="true"
			[nzOuterBordered]="true"
			[nzPageIndex]="1"
			[nzPageSize]="50"
			[nzShowSizeChanger]="true"
			[nzPageSizeOptions]="[50, 100, 150, 200]"
			[nzVirtualItemSize]="20"
			[nzData]="tableData()"
		>
			<thead>
				<tr>
					<th>Номер вопроса</th>
					<th>Состояние</th>
					<th>Балл</th>
					<th></th>
				</tr>
			</thead>
			<tbody>
				@for (data of resultTable.data; track data) {
					<tr>
						<td>{{ data.id }}</td>
						<td>{{ data.status }}</td>
						<td>{{ data.score ?? '-' }}</td>
						<td>
							<button
								nz-button
								nzType="primary"
								nzSize="small"
								type="button"
								(click)="showQuestion(data.id)"
							>
								<nz-icon nzType="eye" nzTheme="outline" />
								Просмотреть вопрос
							</button>
						</td>
					</tr>
				}
			</tbody>
		</nz-table>
	</div>
}
